# Maintainer: Shrinivas Vishnu Kumbhar <shrinivas.v.kumbhar@gmail.com>
pkgname=shani-desktop-gnome
pkgver=1.2
pkgrel=13
pkgdesc="GNOME desktop environment for Shani OS"
arch=('any')
license=('GPL')
depends=(
	gdm
	mutter
	gpaste
	baobab
	malcontent
	rygel
	power-profiles-daemon
	switcheroo-control
	usbguard
	system-config-printer
	evolution-data-server
	gnome-initial-setup
	gnome-browser-connector
	gnome-backgrounds
	gnome-console
	gnome-control-center
	gnome-disk-utility
	gnome-menus
	gnome-shell
	gnome-shell-extension-appindicator
	gnome-shell-extension-caffeine
	gnome-session
	gnome-settings-daemon
	gnome-user-share
	gnome-remote-desktop
	gnome-system-monitor
	gnome-keyring
	gnome-screenshot
	gnome-nettool
	gnome-software
	gnome-firmware
	gnome-logs
	nautilus
	nautilus-image-converter
	nautilus-share
	gvfs
	gvfs-afc
	gvfs-dnssd
	gvfs-goa
	gvfs-gphoto2
	gvfs-google
	gvfs-mtp
	gvfs-nfs
	gvfs-onedrive
	gvfs-smb
	gvfs-wsdd
	webp-pixbuf-loader
	libwmf
	libopenraw
	ffmpegthumbnailer
	xdg-desktop-portal-gnome
	xdg-user-dirs-gtk
	xdg-utils
	adwaita-fonts
	papirus-icon-theme
	gnome-themes-extra
)
install="$pkgname.install"
source=()
md5sums=()

package() {
	# Copy etc and usr directories to the package directory
	cp -r etc "$pkgdir"/
	cp -r usr "$pkgdir"/

	# Ensure directories exist
	install -d "$pkgdir/usr/share/gnome-background-properties"

	# Generate GNOME wallpaper XML dynamically
	XML_FILE="$pkgdir/usr/share/gnome-background-properties/shani-wallpapers.xml"
	WALLPAPER_DIR="$pkgdir/usr/share/backgrounds/shani"

	echo '<?xml version="1.0" encoding="UTF-8"?>' > "$XML_FILE"
	echo "<wallpapers>" >> "$XML_FILE"

	for file in "$WALLPAPER_DIR"/*.{png,jpg,jpeg,webp}; do
		[ -e "$file" ] || continue  # Skip if no matching files
		filename=$(basename "$file")
		name="${filename%.*}"  # Remove extension

		echo "  <wallpaper>" >> "$XML_FILE"
		echo "    <name>${name//-/ }</name>" >> "$XML_FILE"
		echo "    <filename>/usr/share/backgrounds/shani/$filename</filename>" >> "$XML_FILE"
		echo "    <options>zoom</options>" >> "$XML_FILE"
		echo "  </wallpaper>" >> "$XML_FILE"
	done

	echo "</wallpapers>" >> "$XML_FILE"
}

